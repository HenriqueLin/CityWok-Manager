{% extends 'layout.html' %}
{% set active_page = "order" %}
{% block content %}
<div>
    <h1>{{title}}</h1>
    <hr>
    <div class="mb-2 d-print-none">
        <a href="{{url_for('order.new')}}" class="btn btn-outline-success">{{_('New')}}</a>
    </div>
    <h3 id="Payed">{{_('Unpayed')}}</h3>
    {% if unpayed.items %}
    <div class="table-responsive">
        <table class="table table-striped table-bordered text-nowrap text-center">
            <thead class="table-dark">
                <tr>
                    <th scope="col">{{_('Order Number')}}</th>
                    <th scope="col">{{_('Delivery Date')}}</th>
                    <th scope="col">{{_('Value')}}</th>
                    <th scope="col">{{_('Supplier')}}</th>
                    <th scope="col">{{_('Detail')}}</th>
                </tr>
            </thead>
            <tbody>
                {% for order in unpayed.items %}
                <tr>
                    <th>
                        <strong>
                            {{ order.order_number }}
                        </strong>
                    </th>
                    <td>{{ moment(order.delivery_date).format('ll') }}</td>
                    <td>{{ order.value }}</td>
                    <td>
                        <a href="{{url_for('supplier.detail',supplier_id=order.supplier.id)}}">
                            {{ order.supplier.name }}
                        </a>
                    </td>
                    <td>
                        <a href="{{url_for('order.detail',order_id=order.id)}}">
                            <span class="material-icons">more_vert</span>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <!-- Pagination Links-->
    <div class="text-end">
        <a href="{{ url_for('order.index', unpayed_page=unpayed.prev_num, payed_page=payed.page) }}"
            class="btn btn-outline-dark btn-sm {% if unpayed.page == 1 %}disabled{% endif %}">
            &laquo;
        </a>
        <!-- Loop through the number of pages to display a link for each-->
        {% for page_num in unpayed.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
        <!-- Check for the active page and set the link to " Active"-->
        {% if unpayed.page == page_num %}
        <a href="{{ url_for('order.index', unpayed_page=page_num, payed_page=payed.page) }}"
            class="btn btn-sm btn-dark">
            {{ page_num }}
        </a>
        {% else %}
        <a href="{{ url_for('order.index', unpayed_page=page_num, payed_page=payed.page) }}"
            class="btn btn-sm btn-outline-dark">
            {{ page_num }}
        </a>
        {% endif %}
        {% else %}
        <span class="material-icons">more_horiz</span>
        {% endif %}
        {% endfor %}
        <a href="{{ url_for('order.index', unpayed_page=unpayed.next_num, payed_page=payed.page) }}"
            class="btn btn-sm btn-outline-dark {% if unpayed.page == unpayed.pages %}disabled{% endif %}">&raquo;</a>
    </div>
    {% endif %}
    <h3 id="Payed">{{_('Payed')}}</h3>
    {% if payed.items %}
    <div class="table-responsive">
        <table class="table table-striped table-bordered text-nowrap text-center">
            <thead class="table-dark">
                <tr>
                    <th scope="col">{{_('Order Number')}}</th>
                    <th scope="col">{{_('Delivery Date')}}</th>
                    <th scope="col">{{_('Value')}}</th>
                    <th scope="col">{{_('Supplier')}}</th>
                    <th scope="col">{{_('Detail')}}</th>
                </tr>
            </thead>
            <tbody>
                {% for order in payed.items %}
                <tr>
                    <th>
                        <strong>
                            {{ order.order_number }}
                        </strong>
                    </th>
                    <td>{{ moment(order.delivery_date).format('ll') }}</td>
                    <td>{{ order.value }}</td>
                    <td>
                        <a href="{{url_for('supplier.detail',supplier_id=order.supplier.id)}}">
                            {{ order.supplier.name }}
                        </a>
                    </td>
                    <td>
                        <a href="{{url_for('order.detail',order_id=order.id)}}">
                            <span class="material-icons">more_vert</span>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <!-- Pagination Links-->
    <div class="text-end">
        <a href="{{ url_for('order.index', payed_page=payed.prev_num, unpayed_page=unpayed.page) }}"
            class="btn btn-outline-dark btn-sm {% if payed.page == 1 %}disabled{% endif %}">
            &laquo;
        </a>
        <!-- Loop through the number of pages to display a link for each-->
        {% for page_num in payed.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
        <!-- Check for the active page and set the link to " Active"-->
        {% if payed.page == page_num %}
        <a href="{{ url_for('order.index', payed_page=page_num, unpayed_page=unpayed.page) }}"
            class="btn btn-sm btn-dark">
            {{ page_num }}
        </a>
        {% else %}
        <a href="{{ url_for('order.index', payed_page=page_num, unpayed_page=unpayed.page) }}"
            class="btn btn-sm btn-outline-dark">
            {{ page_num }}
        </a>
        {% endif %}
        {% else %}
        <span class="material-icons">more_horiz</span>
        {% endif %}
        {% endfor %}
        <a href="{{ url_for('order.index', payed_page=payed.next_num, unpayed_page=unpayed.page) }}"
            class="btn btn-sm btn-outline-dark {% if payed.page == payed.pages %}disabled{% endif %}">&raquo;</a>
    </div>
    {% endif %}
</div>

{% endblock content %}